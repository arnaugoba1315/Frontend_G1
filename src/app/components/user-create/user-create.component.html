<div class="user-create-container">
  <div class="header-with-back">
    <button type="button" class="btn-back" (click)="cancel()">
      <i class="material-icons">arrow_back</i> Tornar
    </button>
    <h2>Crear nou usuari</h2>
  </div>

  <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <div *ngIf="error" class="alert alert-danger">{{ error }}</div>
    
    <div class="form-group">
      <label for="username">Nom d'usuari*</label>
      <input 
        type="text" 
        id="username"
        formControlName="username" 
        class="form-control" 
        [ngClass]="{ 'is-invalid': hasError('username', 'required') || hasError('username', 'minlength') }" 
      />
      <div *ngIf="hasError('username', 'required')" class="invalid-feedback">
        El nom d'usuari és obligatori
      </div>
      <div *ngIf="hasError('username', 'minlength')" class="invalid-feedback">
        El nom d'usuari ha de tenir com a mínim 4 caràcters
      </div>
    </div>

    <div class="form-group">
      <label for="email">Correu electrònic*</label>
      <input 
        type="email" 
        id="email"
        formControlName="email" 
        class="form-control" 
        [ngClass]="{ 'is-invalid': hasError('email', 'required') || hasError('email', 'email') }" 
      />
      <div *ngIf="hasError('email', 'required')" class="invalid-feedback">
        El correu electrònic és obligatori
      </div>
      <div *ngIf="hasError('email', 'email')" class="invalid-feedback">
        Correu electrònic invàlid
      </div>
    </div>

    <div class="form-group">
      <label for="password">Contrasenya*</label>
      <input 
        type="password" 
        id="password"
        formControlName="password" 
        class="form-control" 
        [ngClass]="{ 'is-invalid': hasError('password', 'required') || hasError('password', 'minlength') }" 
      />
      <div *ngIf="hasError('password', 'required')" class="invalid-feedback">
        La contrasenya és obligatòria
      </div>
      <div *ngIf="hasError('password', 'minlength')" class="invalid-feedback">
        La contrasenya ha de tenir com a mínim 6 caràcters
      </div>
    </div>

    <div class="form-row">
      <div class="form-group form-group-half">
        <label for="level">Nivell*</label>
        <input 
          type="number" 
          id="level"
          formControlName="level" 
          class="form-control" 
          [ngClass]="{ 'is-invalid': hasError('level', 'required') || hasError('level', 'min') }" 
        />
        <div *ngIf="hasError('level', 'required')" class="invalid-feedback">
          El nivell és obligatori
        </div>
        <div *ngIf="hasError('level', 'min')" class="invalid-feedback">
          El nivell no pot ser inferior a 1
        </div>
      </div>
      
      <div class="form-group form-group-half">
        <label for="profilePicture">Enllaç de l'imatge de perfil</label>
        <input 
          type="text" 
          id="profilePicture"
          formControlName="profilePicture" 
          class="form-control" 
        />
      </div>
    </div>

    <div class="form-group">
      <label for="bio">Biografia</label>
      <textarea 
        id="bio"
        formControlName="bio" 
        class="form-control" 
        rows="3"
      ></textarea>
    </div>

    <div class="form-actions">
      <button 
        type="button" 
        class="btn btn-secondary" 
        (click)="cancel()"
      >
        Cancelar
      </button>
      <button 
        type="submit" 
        class="btn btn-primary" 
        [disabled]="loading"
      >
        <span *ngIf="loading" class="spinner-border spinner-border-sm mr-1"></span>
        Crear usuari
      </button>
    </div>
  </form>
</div>